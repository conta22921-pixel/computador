name: Build Flet Android APK - Artifact Download Link

# ... (on: push: branches: ["main"] e workflow_dispatch)

jobs:
  build_android:
    # ... (steps de Checkout, Setup Flutter, Setup Python, Install Flet, Flet Build APK)

      # 1. UPLOAD DO ARTIFACT
      - name: üì§ Upload APK Artifact
        id: upload_artifact
        uses: actions/upload-artifact@v4
        with:
          name: newapp-android-apk
          # CR√çTICO: Tenta os dois caminhos poss√≠veis
          path: |
            build/app/outputs/flutter-apk/app-release.apk
            build/apk/app-release.apk
          if-no-files-found: error
          
      # 2. ENVIO DO LINK DE DOWNLOAD DO ZIP PARA O TELEGRAM
      - name: üöÄ Enviar Link de Download para Telegram
        if: success()
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          parse_mode: markdown
          
          # CRIA√á√ÉO DO LINK DE DOWNLOAD DIRETO DO ZIP DO ARTIFACT
          message: |
            ‚úÖ *Novo Build Flet Android Dispon√≠vel!*
            
            ‚ö†Ô∏è *ATEN√á√ÉO: Este link baixa o ZIP do Artifact, exige login e expira.*
            
            Branch: `${{ github.ref_name }}`
            
            üì• [CLIQUE AQUI PARA BAIXAR O ZIP](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}/artifacts)
            
            [Ver na P√°gina do GitHub Actions](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})
